#1.What are the details of all cars purchased in the year 2022?

SELECT 
c.car_id,c.make,c.make,c.type,c.style,c.cost_$,s.sale_id,
s.salesman_id,s.purchase_date
FROM cars c 
JOIN sales s ON c.car_id =s.car_id 
WHERE YEAR(s.purchase_date)=2022;

# 2.What is the total number of cars sold by each salesperson?

SELECT 
s.salesman_id , 
sp.name as salesperson, 
count(sale_id) AS total_cars_sold 
FROM salespersons sp
JOIN sales s ON sp.salesman_id = s.salesman_id
GROUP BY sp.name, s.salesman_id ;

 # 3.What is the total revenue generated by each salesperson? 

SELECT 
 s.salesman_id , sp.name as salesperson, 
 SUM(cost_$) AS total_revenue FROM salespersons sp
JOIN sales s ON sp.salesman_id = s.salesman_id
JOIN cars c ON s.car_id=c.car_id
GROUP BY sp.name, s.salesman_id ;

# 4.What are the details of the cars sold by each salesperson? 

SELECT 
sp.salesman_id , sp.name , c.car_id,c.make,
c.type,c.style,c.cost_$ 
FROM salespersons sp
JOIN sales s ON sp.salesman_id=s.salesman_id 
JOIN cars c ON s.car_id=c.car_id 
GROUP BY s.salesman_id ,c.car_id,sp.name ;

# 5.What is the total revenue generated by each car type?

SELECT  
c.car_id, c.type, sum(cost_$) AS total_revenue 
FROM cars c 
JOIN sales s ON c.car_id = s.car_id
GROUP BY  c.type, c.car_id;

# 6.What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

SELECT 
  sp.name,s.salesman_id,c.car_id,
  c.make,c.type,c.style,c.cost_$
FROM cars c JOIN sales s ON c.car_id=s.car_id
JOIN salespersons sp ON s.sale_id = sp.salesman_id 
WHERE YEAR(s.purchase_date)=2021 
AND sp.name='Emily Wong';

 
 #7. What is the total revenue generated by the sales of hatchback cars?
  
  SELECT 
    style ,sum(cost_$) AS revenue_from_hatchback_cars 
  FROM cars 
  JOIN sales ON cars.car_id=sales.car_id
  WHERE style = "hatchback";
 
 
  #8.What is the total revenue generated by the sales of SUV cars in the year 2022?
  
  SELECT 
    sum(cost_$) AS revenue_from_SUV_cars_2022 FROM cars 
  JOIN sales ON cars.car_id=sales.car_id
  WHERE style = "SUV" 
  AND YEAR(purchase_date)=2022;
  
  # 9.What is the name and city of the salesperson who sold the most number of cars in the year 2023?
  
  SELECT 
    sp.salesman_id,sp.name,sp.city, 
    count(s.sale_id) AS total_car_sold_2023
  FROM salespersons sp 
  JOIN sales s ON sp.salesman_id=s.salesman_id 
  WHERE YEAR(s.purchase_date)=2023
  GROUP BY sp.salesman_id,sp.name,sp.city
  ORDER BY COUNT(s.sale_id) DESC LIMIT 1 ; 
  
  # 10.What is the name and age of the salesperson who generated the highest revenue in the year 2022?
  
  SELECT 
  sp.name,sp.age,SUM(c.cost_$) AS highest_revenue_2022 
  FROM	salespersons sp JOIN sales s 
  ON s.salesman_id=sp.salesman_id
  JOIN cars c ON s.car_id = c.car_id 
  WHERE YEAR(s.purchase_date) = 2022
  GROUP BY  sp.name,sp.age 
  ORDER BY SUM(c.cost_$) DESC LIMIT 1;
